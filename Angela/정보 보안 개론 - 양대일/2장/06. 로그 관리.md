 - 사용자 로그인 -> 시스템의 명령 과정 시 Authentication(인증), Authorization(인가), Accounting으로 구분 (AAA)
 ## 1. Authentication(인증) - 자신의 신원을 시스템에 증명하는 과정 -> ID, 패스워드 입력
 ## 2. Authorization(인가) - 로그인이 허락된 사용자로 판명, 로그인하는 과정
 ## 3. Accounting - 로그인했을 때 시스템이 이에 대한 기록을 나기는 과정
  - 해커 or 악의적으로 시스템에 접근한 사용자 파악에 유용
  - 책임 추적성 : 추적에 대한 기록의 충실도
  - 감사 추적 : 보안과 관련하여 시간대별 이벤트를 기록한 로그

# 1. 운영체제의 로그 관리
## - 윈도우는 "event"라고 불리는 중앙 집중적 형태 VS 유닉스는 여러 곳에 산발적으로 저장
 - 중앙 집중적 형태 : 로그 관리가 편함 but 공격자도 한 로그만 삭제하면 됨
 - 분산적 형태 : 초보자가 로그 찾기 힘듦 but 공격자도 모든 로그 삭제 어려움
 ## -> 유닉스가 윈도우보다 공격자 찾기 수월

# 윈도우의 로그
 - 로깅 항목 : [제어판]-[관리 도구]-[로컬 보안 정책]-[감사 정책] 메뉴
 - 실제 로그 확인 : [제어판]-[관리 도구]-[이벤트 뷰어]

 ### 표시 항목 : 
 1. 종류 - 성공 감사/실패 감사로 나뉨. 성공 감사는 어떠한 시도를 성공했을 때, 실패 감사는 실패했을 때에 남김
 2. 날짜, 시간 - 로그를 남긴 날짜와 시간
 3. 원본, 범주 - 로그와 관계있는 영역
 4. 이벤트 - 각 로그별로 고유한 번호를 부여함
 5. 사용자 - 로그를 발생시킨 사용자
 6. 컴퓨터 - 로그를 발생시킨 시스템

 ### 로그 종류 : 
 - 개체 액세스 감사 -> 특정 파일/디렉터리/레지스트리 키 등의 객체에 접근을 시도하거나 속성 변경하는 것 등등 탐지
 - 계정 관리 감사 -> 신규 사용자 그룹 추가, 기존 사용자 그룹 변경, 사용자 활성화\비활성화, 계정 pw 변경
 - 계정 로그인 이벤트 감사 -> 계정의 로그인 사항 감사(도메인 계정 사용 시 생성)
 - 권한 시용 감사 -> 권한 설정 변경, 관리자 권한 수행 시 기록
 - 로그인 이벤트 감사 -> 계정의 로그인 사항 감사(로컬 계정 사용 시 생성)
 - 디렉터리 서비스 액세스 감사 -> 시스템 엑세스 제어 목록이 지정되어 있는 액치브 디렉터리 개체에 접근하는 사용자에 대한 감사 로그 기록
 - 정책 변경 감사 -> 사용자 권한 할당 정책, 감사 정책, 신뢰 정책의 변경과 관련된 사항 기록
 - 프로세스 추적 감사 -> 사용자 또는 프로그램이 프로세스를 시작하거나 중지할 때 발생
 - 시스템 이벤트 -> 시스템의 시작/종료, 보안 로그 삭제 등
 - microsoft.com/download/details.aspx/?id=50034

# 유닉스의 로그
	 - /var/adm : 솔라리스, HP-UX 10.x 이후, 

 ## 로그 종류
  - utemp : 현재 로그인한 사용자의 ID, 사용자 프로세스, 실행 레벨, 로그인 종류 등
		 - 로그인 계정 이름, 로그인 환경(initab id), 로그인 디바이스(console, try 등), 로그인 셸의 프로세스 id, 로그인 계정의 형식, 로그오프 여부, 시간에 대한 저장 구조(structure) 등
		 - binary 형태로 로그 저장
		 - w, who, users, whodo, finger 등의 명령어

  - wtemp : 사용자 로그인/로그아웃 시간, IP와 세션 지속 시간, 시스템 종료/시작 시간
		 - last [원하는 항목] 명령어

  - secure(sulog) : 원격자 접속 로그, su, 사용자 생성 등과 같이 보안에 직접적 관련된 로그 저장
		 - [날짜] [시간] [+(성공) or -(실패)] [터미널 종류] [권한 변경 전 계정 - 권한 변경 후 계정]
		 - /var/adm/sulog

  - history : 명령 창에서 실행한 명령
  - syslog : 시스템 운영과 관련한 전반적 로그
		 - /var/log/messages

# 2. 데이터베이스스의 로그 관리
## - 데이터 유출과 직접적 연관

# MS-SQL의 로그
 - 로그 확인 : 서버 선택 -> [보안]-[일반 로그인 감사, C2 감사 추적]
 - 기본 설정 : Failed logins only
 - C2 감사추적 -> 권고하지 않음(대량의 데이터 -> DB 무리)

# MySQL의 로그
 ### 로그 종류 : 
 - Error 로그 -> 확장자 .err 파일, 데이터 디렉토리에 생성. MySQL의 구동/모니터링/쿼리 에러 메세지 포함. 기본적으로 저장
 - General 로그 -> 쿼리 전체 저장, show variables like 'general%';
		 - set global general_log = ON/OFF

 - Slow Query 로그 -> General + 실행 완료 시간 -> 실행 도중 에러 기록x

 - Binary 로그 & Relay 로그
		  - Binary 로그 : DB, 테이블 변경 사항, binary 파일 -> MySQL 복제 or 특정 시점 복구
		  - Binary 로그는 마스터에서, Relay 로그는 슬레이브에서 생성 (포맷, 내용 동일)

# 오라클의 로그

 - 기본 설정 - $ORACLE_HOME/dbs/init.ora의 AUDIT_TRAIL을 'DB' 또는 'TRUE'로 변경
 - 설정값 :
	 - NONE 또는 FALSE : DB 감사 비활성화
	 - DB 또는 TRUE : DB 감사 활성화
	 - OS : audit_file_dest 경로에 OS상의 파일로 감사 결과 저장

 ### 로그 종류 : 
 - 문장 감사 -> 지정된 문장 실행 시의 기록
	 - 예) AUDIT TABLE BY wishfree : 사용자 wishfree의 table에 대한 감사 활성화 -> create table, drop table, turncate table, comment on table, delete from table 등의 작업 수행 시 모두 기록 남김
	 - 예) AUDIT SESSION BY wishfree, daniel : 사용자 wishfree, daniel에 대한 감사 활성화
 - 권한 감사 -> 특정 권한 사용 시 기록
	 - 예) AUDIT DELETE ANY TABLE BY ACCESS WHENEVER NOT SUCCESSFUL : 어떤 테이블이든 삭제 시도 시 성공 유무에 관계없이 기록

 - 객체 감사 -> 특정 개체에 대해 작업 시 기록
	 - 예) AUDIT select ON wishfree.test BY session WHENEVER successful : 사용자 wishfree의 test table에 대한 select가 실행되어 성공한 경우 세션별로 로그 기록

 ### 주요 감사 뷰 : 
 - dba_stmt_audit_opst : 문장 감사 옵션 확인
 - dba_priv_audit_opst : 권한 감사 옵션 확인
 - dba_obj_audit_opst : 객체 감사 옵션 확인
 - dba_audit_trail : 모든 감사 로그 출력
 - dba_audit_object : DB 객체와 관련된 모든 감사 로그 출력
 - user_audit_object : 현재 사용자의 객체와 관련된 모든 감사 로그 출력
 - dba_audit_session : 사용자 로그인/로그오프 감사 기록 출력
 - dba_audit_statement : 문장 감사 로그 출력

## - 태핑 장비 도입 추천


# 3. 응용 프로그램의 로그 관리
## - 웹 서버, FTP 서버
 - 웹 해킹에 관한 지식 습득 우선
 - 취약점 분석 후 어떤 로그가 나오는지 확인해보는 것 추천

# IIS의 로그
 - 로그 확인 : [제어판]-[관리 도구]-[IIS 관리자]-[IIS]-'로깅'
 - 'W3C 확장 로그 파일 형식'으로 저장![[Pasted image 20250515205052.png]]
 
 - 예시 :
	 - 2021-06-03 08:53:12 192.168.137.128
	 - GET/XSS/GetCookie.asp?cookie=ASPSESSIONIDQQ CAQDDA 80 - 192.168.137.1
	 - Mozilla/5.0+(compatibla;+MSIE+9.0;+Windows+NT+6.1;) 200 0 0 225

	 - 날짜와 시간
	 - 서버 IP
	 - HTTP 접근 방법과 URL : GET/...
	 - 서버 포트
	 - 클라이언트 IP
	 - 클라이언트의 웹 브라우저
	 - 실행 결과 코드
	 - 서버에서 클라이언트로 전송한 데이터의 크기 
	 - 클라이언트에서 서버로 전송한 데이터의 크기
	 - 처리 소요 시간

# 아파치의 로그
 - 기본 combined의 형식으로 access_log에 저장(httpd.conf에서 확인 가능)
 - 
 ### 로그 종류 : 
 - ![[Pasted image 20250515211311.png]]
 - 예) 192.168.137.1 - - [06/JUN/2017:05:48:28 +900] "GET/HTTP/1.1" 403 4609 "-" "Mozilla/5.0 (compatibla; MSIE+9.0; Windows NT 6.1; WOW64; Trident/5.0)"
 - 클라이언트 IP(%h)
 - 클라이언트 로그인명(%l)
 - 클라이언트 사용자명(%u)
 - 날짜와 시간
 - HTTP 접근 방법과 접근 URL
 - 실행 결과 코드
 - 서버에서 클라이언트로 전송한 데이터의 크기 
 - 클라이언트의 웹 브라우저

# 4. 네트워크 장비의 로그 관리
## - 별 거 없음